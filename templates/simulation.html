{% extends "base.html" %}

{% block title %}Live Simulation - Adaptive Traffic Light System{% endblock %}

{% block content %}
<h2>Live Traffic Simulation</h2>
<div id="traffic-dashboard">
    <div class="card">
        <div class="card-title">North-South</div>
        <div class="metric"><span id="ns-count">0</span> vehicles</div>
    </div>
    <div class="card">
        <div class="card-title">East-West</div>
        <div class="metric"><span id="ew-count">0</span> vehicles</div>
    </div>
    <div id="signals" class="card">
        <div class="card-title">Signals</div>
        <div class="signal-row"><span class="badge" id="ns-light">N-S: ðŸ”´</span></div>
        <div class="signal-row"><span class="badge" id="ew-light">E-W: ðŸ”´</span></div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script>
function updateTraffic() {
    fetch('/traffic-data')
        .then(response => response.json())
        .then(data => {
            document.getElementById('ns-count').innerText = data.north_south;
            document.getElementById('ew-count').innerText = data.east_west;
            // simple logic for lights
            document.getElementById('ns-light').innerText = data.north_south >= data.east_west ? 'N-S Light: ðŸŸ¢' : 'N-S Light: ðŸ”´';
            document.getElementById('ew-light').innerText = data.east_west > data.north_south ? 'E-W Light: ðŸŸ¢' : 'E-W Light: ðŸ”´';
        });
}
setInterval(updateTraffic, 2000);
updateTraffic();
</script>
{% endblock %}
